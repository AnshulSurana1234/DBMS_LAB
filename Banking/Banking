create databse Banking;
use Banking;
CREATE TABLE BRANCH(
BRANCHNAME VARCHAR(25), 
BRANCHCITY VARCHAR(20), 
ASSETS REAL,
PRIMARY KEY (BRANCHNAME)
);

CREATE TABLE BANKACCOUNT (
ACCNO INT,
BRANCHNAME VARCHAR(25),
BALANCE REAL,
PRIMARY KEY (ACCNO),
FOREIGN KEY (BRANCHNAME) REFERENCES BRANCH(BRANCHNAME)
);

CREATE TABLE DEPOSITOR (
CUSTOMERNAME VARCHAR(15), 
ACCNO INT,
FOREIGN KEY (CUSTOMERNAME) REFERENCES BANKCUSTOMER(CUSTOMERNAME),
FOREIGN KEY (ACCNO) REFERENCES BANKACCOUNT(ACCNO)
);

CREATE TABLE LOAN (
LOANNUMBER int,
BRANCHNAME VARCHAR(25), 
AMOUNT INT,
PRIMARY KEY (LOANNUMBER),
FOREIGN KEY (BRANCHNAME) REFERENCES BRANCH(BRANCHNAME) 
);

CREATE TABLE BANKCUSTOMER (
CUSTOMERNAME VARCHAR(15),
CUTOMERSTREET VARCHAR(25),
CUSSTOMERCITY VARCHAR(20),
PRIMARY KEY (CUSTOMERNAME)
);

INSERT INTO BRANCH
VALUES ('SBI_Chamrajpet','Bangalore',50000),('SBI_ResidencyRoad','Bangalore',10000),('SBI_ShivajiRoad','Bombay',20000),('SBI_ParlimentRoad','Delhi',10000),('SBI_Jantarmantar','Delhi',20000);

INSERT INTO BANKACCOUNT
VALUES (1,'SBI_Chamrajpet',2000),(2,'SBI_ResidencyRoad',5000),(3,'SBI_ShivajiRoad',6000),(4,'SBI_ParlimentRoad',9000),(5,'SBI_Jantarmantar',8000),(6,'SBI_ShivajiRoad',4000),(8,'SBI_ResidencyRoad',4000),(9,'SBI_ParlimentRoad',3000),(10,'SBI_ResidencyRoad',5000),(11,'SBI_Jantarmantar',2000);

INSERT INTO BANKCUSTOMER
VALUES ('Avinash','Bull_Temple_Road','Bangalore'),('Dinesh','Bannergatta_Road','Bangalore'),('Mohan','NationalCollege_Road','Bangalore'),('Nikil','Akbar_Road','Delhi'),('Ravi','Prithviraj_Road','Delhi');

INSERT INTO DEPOSITOR
VALUES ('Avinash',1),('Dinesh',2),('Nikil',4),('Ravi',5),('Avinash',8),('Nikil',9),('Dinesh',10),('Nikil',11);

INSERT INTO LOAN
VALUES (1,'SBI_Chamrajpet',1000),(2,'SBI_ResidencyRoad',2000),(3,'SBI_ShivajiRoad',3000),(4,'SBI_ParlimentRoad',4000),(5,'SBI_Jantarmantar',5000);

SELECT d.CUSTOMERNAME 
FROM BANKACCOUNT a, DEPOSITOR d 
WHERE d.ACCNO=a.ACCNO AND a.BRANCHNAME="SBI_ResidencyRoad" 
GROUP BY d.CUSTOMERNAME 
having count(d.CUSTOMERNAME)>=2;

SELECT d.CUSTOMERNAME
FROM BANKACCOUNT a, DEPOSITOR d, BRANCH b 
WHERE d.ACCNO=a.ACCNO AND b.BRANCHNAME=a.BRANCHNAME AND b.BRANCHCITY="Delhi" 
GROUP BY d.CUSTOMERNAME
having count(distinct b.BRANCHNAME)=(SELECT COUNT(BRANCHNAME) 
									  FROM BRANCH
                                      WHERE BRANCHCITY="Delhi");
                                      
DELETE FROM BANKACCOUNT
WHERE BRANCHNAME IN(SELECT BRANCHNAME
					 FROM BRANCH 
                     WHERE BRANCHCITY='Bombay');
